{
  "hash": "1572c5ba4b61f6825ca11d0646156d2c",
  "result": {
    "markdown": "---\ntitle: \"Regression and Statistical Inference - Assignment 3\"\nauthor: \"Hilal Sankari\"\nformat: \n    html:\n      code-line-numbers: true\n      df-print: paged\n\n---\n\n----\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-1_82bb26cc02416aad39fa87f6009ff03b'}\n\n```{.r .cell-code}\n# Load Libraries\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:stats':\n#> \n#>     filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:base':\n#> \n#>     intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(modelr)\n```\n:::\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-2_9007e141f98a247949a64ccb880941ab'}\n\n```{.r .cell-code}\n# Load data\n# Read data set. Check what folder/path your data is in. \ncar_data <- readRDS(\"C:/Users/user/Documents/TUHH/Causal/Causal_Data_Science_Data/car_prices.rds\")\n```\n:::\n\n# **Part1**\n#### **Number of rows and columns**\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-3_da8bc10ab69d3fb006ced7720783daf8'}\n\n```{.r .cell-code}\nrows_columns <- dim(car_data)\nrows <- rows_columns[1]\ncolumns <- rows_columns[2]\n```\n:::\n\n#### **Number of rows and columns**\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-4_d132008f936492afb03e18a80facebe5'}\n\n```{.r .cell-code  code-fold=\"true\"}\ncat(\"Number of rows:\", rows, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Number of rows: 181\n```\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\ncat(\"Number of columns:\", columns, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Number of columns: 22\n```\n:::\n:::\n\n# **Part2**\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-5_f5bc2008b275a72b8f9c4f4b8f716a4e'}\n\n```{.r .cell-code}\n# Extract column names for each data frame in the list\ncolumn_names_list <- lapply(car_data, colnames)\nfirst_element <- head(car_data$carwidth, 1)\ncat(\"the type of carwidth is\", typeof(first_element), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> the type of carwidth is double\n```\n:::\n\n```{.r .cell-code}\nfirst_element <- head(car_data$carbody, 1)\ncat(\"the type of carbody is\", typeof(first_element), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> the type of carbody is character\n```\n:::\n\n```{.r .cell-code}\nprint(\"There are two types: char and double\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"There are two types: char and double\"\n```\n:::\n:::\n\n::: {.callout-important appearance=\"minimal\"}\nNumeric types like double are ideal for quantitative information, while strings and char are useful for textual and categorical information. The key is to accurately represent the real-world attributes of the cars and associated market data in your program.\n:::\n# **Part3**\n#### **Linear Regression**\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-6_e5eb3024038ee929c25bed17d26510c4'}\n\n```{.r .cell-code}\nglimpse(car_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Rows: 181\n#> Columns: 22\n#> $ aspiration       <chr> \"std\", \"std\", \"std\", \"std\", \"std\", \"std\", \"std\", \"std…\n#> $ doornumber       <chr> \"two\", \"two\", \"two\", \"four\", \"four\", \"two\", \"four\", \"…\n#> $ carbody          <chr> \"convertible\", \"convertible\", \"hatchback\", \"sedan\", \"…\n#> $ drivewheel       <chr> \"rwd\", \"rwd\", \"rwd\", \"fwd\", \"4wd\", \"fwd\", \"fwd\", \"fwd…\n#> $ enginelocation   <chr> \"front\", \"front\", \"front\", \"front\", \"front\", \"front\",…\n#> $ wheelbase        <dbl> 88.6, 88.6, 94.5, 99.8, 99.4, 99.8, 105.8, 105.8, 105…\n#> $ carlength        <dbl> 168.8, 168.8, 171.2, 176.6, 176.6, 177.3, 192.7, 192.…\n#> $ carwidth         <dbl> 64.1, 64.1, 65.5, 66.2, 66.4, 66.3, 71.4, 71.4, 71.4,…\n#> $ carheight        <dbl> 48.8, 48.8, 52.4, 54.3, 54.3, 53.1, 55.7, 55.7, 55.9,…\n#> $ curbweight       <dbl> 2548, 2548, 2823, 2337, 2824, 2507, 2844, 2954, 3086,…\n#> $ enginetype       <chr> \"dohc\", \"dohc\", \"ohcv\", \"ohc\", \"ohc\", \"ohc\", \"ohc\", \"…\n#> $ cylindernumber   <chr> \"four\", \"four\", \"six\", \"four\", \"five\", \"five\", \"five\"…\n#> $ enginesize       <dbl> 130, 130, 152, 109, 136, 136, 136, 136, 131, 131, 108…\n#> $ fuelsystem       <chr> \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi…\n#> $ boreratio        <dbl> 3.47, 3.47, 2.68, 3.19, 3.19, 3.19, 3.19, 3.19, 3.13,…\n#> $ stroke           <dbl> 2.68, 2.68, 3.47, 3.40, 3.40, 3.40, 3.40, 3.40, 3.40,…\n#> $ compressionratio <dbl> 9.00, 9.00, 9.00, 10.00, 8.00, 8.50, 8.50, 8.50, 8.30…\n#> $ horsepower       <dbl> 111, 111, 154, 102, 115, 110, 110, 110, 140, 160, 101…\n#> $ peakrpm          <dbl> 5000, 5000, 5000, 5500, 5500, 5500, 5500, 5500, 5500,…\n#> $ citympg          <dbl> 21, 21, 19, 24, 18, 19, 19, 19, 17, 16, 23, 23, 21, 2…\n#> $ highwaympg       <dbl> 27, 27, 26, 30, 22, 25, 25, 25, 20, 22, 29, 29, 28, 2…\n#> $ price            <dbl> 13495.00, 16500.00, 16500.00, 13950.00, 17450.00, 152…\n```\n:::\n\n```{.r .cell-code}\ncar_data[] <- lapply(car_data, as.numeric)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in lapply(car_data, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_data, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_data, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_data, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_data, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_data, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_data, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_data, as.numeric): NAs introduced by coercion\n```\n:::\n\n```{.r .cell-code}\ncar_data %>%\n  # Calculate the correlation matrix\n  cor() %>% \n  # Round the correlation values to 2 decimal places\n  round(2) %>% \n  # Extract the lower triangular part of the matrix\n  Matrix::tril()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> 22 x 22 Matrix of class \"dtrMatrix\"\n#>                  aspiration doornumber carbody drivewheel enginelocation\n#> aspiration             1.00          .       .          .              .\n#> doornumber               NA       1.00       .          .              .\n#> carbody                  NA         NA    1.00          .              .\n#> drivewheel               NA         NA      NA       1.00              .\n#> enginelocation           NA         NA      NA         NA           1.00\n#> wheelbase                NA         NA      NA         NA             NA\n#> carlength                NA         NA      NA         NA             NA\n#> carwidth                 NA         NA      NA         NA             NA\n#> carheight                NA         NA      NA         NA             NA\n#> curbweight               NA         NA      NA         NA             NA\n#> enginetype               NA         NA      NA         NA             NA\n#> cylindernumber           NA         NA      NA         NA             NA\n#> enginesize               NA         NA      NA         NA             NA\n#> fuelsystem               NA         NA      NA         NA             NA\n#> boreratio                NA         NA      NA         NA             NA\n#> stroke                   NA         NA      NA         NA             NA\n#> compressionratio         NA         NA      NA         NA             NA\n#> horsepower               NA         NA      NA         NA             NA\n#> peakrpm                  NA         NA      NA         NA             NA\n#> citympg                  NA         NA      NA         NA             NA\n#> highwaympg               NA         NA      NA         NA             NA\n#> price                    NA         NA      NA         NA             NA\n#>                  wheelbase carlength carwidth carheight curbweight enginetype\n#> aspiration               .         .        .         .          .          .\n#> doornumber               .         .        .         .          .          .\n#> carbody                  .         .        .         .          .          .\n#> drivewheel               .         .        .         .          .          .\n#> enginelocation           .         .        .         .          .          .\n#> wheelbase             1.00         .        .         .          .          .\n#> carlength             0.86      1.00        .         .          .          .\n#> carwidth              0.77      0.83     1.00         .          .          .\n#> carheight             0.54      0.44     0.20      1.00          .          .\n#> curbweight            0.74      0.87     0.85      0.21       1.00          .\n#> enginetype              NA        NA       NA        NA         NA       1.00\n#> cylindernumber          NA        NA       NA        NA         NA         NA\n#> enginesize            0.55      0.68     0.74     -0.02       0.87         NA\n#> fuelsystem              NA        NA       NA        NA         NA         NA\n#> boreratio             0.46      0.60     0.55      0.14       0.64         NA\n#> stroke                0.07      0.07     0.11     -0.15       0.10         NA\n#> compressionratio     -0.26     -0.25    -0.25     -0.05      -0.31         NA\n#> horsepower            0.40      0.60     0.70     -0.09       0.82         NA\n#> peakrpm              -0.22     -0.19    -0.11     -0.15      -0.16         NA\n#> citympg              -0.58     -0.78    -0.74     -0.15      -0.87         NA\n#> highwaympg           -0.63     -0.79    -0.75     -0.18      -0.89         NA\n#> price                 0.56      0.67     0.74      0.07       0.83         NA\n#>                  cylindernumber enginesize fuelsystem boreratio stroke\n#> aspiration                    .          .          .         .      .\n#> doornumber                    .          .          .         .      .\n#> carbody                       .          .          .         .      .\n#> drivewheel                    .          .          .         .      .\n#> enginelocation                .          .          .         .      .\n#> wheelbase                     .          .          .         .      .\n#> carlength                     .          .          .         .      .\n#> carwidth                      .          .          .         .      .\n#> carheight                     .          .          .         .      .\n#> curbweight                    .          .          .         .      .\n#> enginetype                    .          .          .         .      .\n#> cylindernumber             1.00          .          .         .      .\n#> enginesize                   NA       1.00          .         .      .\n#> fuelsystem                   NA         NA       1.00         .      .\n#> boreratio                    NA       0.58         NA      1.00      .\n#> stroke                       NA       0.18         NA     -0.10   1.00\n#> compressionratio             NA      -0.16         NA     -0.20  -0.30\n#> horsepower                   NA       0.85         NA      0.59   0.11\n#> peakrpm                      NA      -0.18         NA     -0.24   0.07\n#> citympg                      NA      -0.74         NA     -0.62  -0.09\n#> highwaympg                   NA      -0.76         NA     -0.61  -0.07\n#> price                        NA       0.89         NA      0.55   0.03\n#>                  compressionratio horsepower peakrpm citympg highwaympg price\n#> aspiration                      .          .       .       .          .     .\n#> doornumber                      .          .       .       .          .     .\n#> carbody                         .          .       .       .          .     .\n#> drivewheel                      .          .       .       .          .     .\n#> enginelocation                  .          .       .       .          .     .\n#> wheelbase                       .          .       .       .          .     .\n#> carlength                       .          .       .       .          .     .\n#> carwidth                        .          .       .       .          .     .\n#> carheight                       .          .       .       .          .     .\n#> curbweight                      .          .       .       .          .     .\n#> enginetype                      .          .       .       .          .     .\n#> cylindernumber                  .          .       .       .          .     .\n#> enginesize                      .          .       .       .          .     .\n#> fuelsystem                      .          .       .       .          .     .\n#> boreratio                       .          .       .       .          .     .\n#> stroke                          .          .       .       .          .     .\n#> compressionratio             1.00          .       .       .          .     .\n#> horsepower                  -0.22       1.00       .       .          .     .\n#> peakrpm                      0.16       0.08    1.00       .          .     .\n#> citympg                      0.44      -0.81    0.03    1.00          .     .\n#> highwaympg                   0.45      -0.78    0.05    0.98       1.00     .\n#> price                       -0.18       0.84   -0.02   -0.74      -0.74  1.00\n```\n:::\n:::\n\n# **Part4.1**\n#### **explain what data type it is and what values it can take on**\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-7_864ab9f2a8e062e2dea40b3bfb18bb3f'}\n\n```{.r .cell-code}\nfirst_element <- head(car_data$enginesize, 1)\nmin_value <- min(car_data$enginesize)\nmax_value <- max(car_data$enginesize)\ncat(\"The regressor chosen is the enginesize and it has a type of \", typeof(first_element),\" and it ranges between\" ,min_value,\" and \", max_value ,\"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> The regressor chosen is the enginesize and it has a type of  double  and it ranges between 61  and  326\n```\n:::\n:::\n\n# **Part4.2**\n::: {.callout-important appearance=\"minimal\"}\nIt affects the price with a percentage of  89% so it has a big effect, and it effects it with a positive correlation so when the engine size increases the price increases (in a proportional manner).\n:::\n# **Part4.3**\n::: {.callout-important appearance=\"minimal\"}\nAs mentioned it affects the price with a 89% , so it does affect it significantly\n:::\n# **Part5**\n#### **Seat Heating**\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-8_4a3ecb5ea1a7e4a47365cd675b746dec'}\n\n```{.r .cell-code}\ncardata_with_seat_heating <- car_data %>%\n  mutate(seat_heatingTRUE = sample(c(TRUE, FALSE), size = nrow(car_data), replace = TRUE))\n\n# Check the distribution of seat_heatingTRUE\ntable(cardata_with_seat_heating$seat_heatingTRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> FALSE  TRUE \n#>    78   103\n```\n:::\n\n```{.r .cell-code}\n# Run the regression again\nlinear_model <- lm(price ~ seat_heatingTRUE, data = cardata_with_seat_heating)\n\n# Print the summary of the linear model\nsummary(linear_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = price ~ seat_heatingTRUE, data = cardata_with_seat_heating)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#>  -9485  -5068  -2812   3644  33640 \n#> \n#> Coefficients:\n#>                      Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)           14635.8      901.6  16.233   <2e-16 ***\n#> seat_heatingTRUETRUE  -2875.7     1195.2  -2.406   0.0171 *  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 7963 on 179 degrees of freedom\n#> Multiple R-squared:  0.03133,\tAdjusted R-squared:  0.02592 \n#> F-statistic: 5.789 on 1 and 179 DF,  p-value: 0.01715\n```\n:::\n:::\n\n::: {.callout-important appearance=\"minimal\"}\nIf all the values are assigned as true there will be no variability, and which can lead to issues in regression analysis, including collinearity problems and difficulties in estimating coefficients.\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}